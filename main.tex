% -----------------------
% Book of ionic
% -----------------------
\documentclass[a4paper]{book}
\author{ionic online}
\title{ionic}
\usepackage{fontspec,xunicode,xltxtra,makeidx,xecolor}
\usepackage{listings,tabularx,amsfonts,amssymb}
\usepackage{amsmath,geometry}
\usepackage{epigraph}
\usepackage{mdwlist}
\usepackage{bchart}
%\usepackage[nonumberlist, toc, acronym]{glossaries}
\usepackage[nonumberlist, toc, acronym]{glossaries}
\usepackage{tikz}
\usetikzlibrary{arrows,shapes,trees,calc,fit,automata,positioning}
\tikzset{
  mybox/.style={
    rectangle,
    rounded corners,
    draw=black
  },
}
\usepackage{lmodern}% to have a large font size for the chapter numbers
\usepackage{lipsum}% just to generate text for the example

\usepackage{color}
\usepackage{titlesec}
\usepackage{amssymb}
\usepackage[colorlinks=false,pdfborder={0 0 0}]{hyperref}
%\setlength{\parindent}{0pt}
%\setlength{\parskip}{\baselineskip}
%\linespread{1.0}

\setcounter{tocdepth}{1}

\setmainfont{WenQuanYi Micro Hei}
\setsansfont{WenQuanYi Micro Hei}
\setmonofont{WenQuanYi Micro Hei}
\setlength{\parindent}{0pt}
\setlength{\parskip}{0.5\baselineskip}
\XeTeXlinebreaklocale "zh"
\XeTeXlinebreakskip=0pt plus 1pt minus 0.1pt

%some global color
\definecolor{light-gray}{rgb}{0.87,0.87,0.87}
\definecolor{light-yellow}{rgb}{0.88,0.92,0.48}
\definecolor{mygreen}{rgb}{0.63,1,0.35}
\definecolor{yanghong}{rgb}{1,0.0,1}

%\newglossary[slg]{symbols}{sym}{sbl}{List of Symbols}

%listing global settings
\lstset{basicstyle=\scriptsize,frame=lines}

%code listing definition
\lstnewenvironment{functionprototype}[1][]
      {\lstset{language=C}\lstset{escapeinside={(*@}{@*)},
       basicstyle=\scriptsize\ttfamily,frame=single,
       numbers=none,numberstyle=\scriptsize,stepnumber=1,numbersep=5pt,
       breaklines=true,
       %firstnumber=last,
           %frame=tblr,
           framesep=5pt,
           showstringspaces=false,
          %identifierstyle=\ttfamily,
           stringstyle=\xecolor{maroon},
        commentstyle=\color{black},
        rulecolor=\color{black},
        xleftmargin=0pt,
        xrightmargin=0pt,
        aboveskip=\medskipamount,
        belowskip=\medskipamount,
               backgroundcolor=\color{white}, #1
}}
{}

%code listing definition
\lstnewenvironment{myccode}[1][]
      {\lstset{language=C}\lstset{escapeinside={(*@}{@*)},
       basicstyle=\scriptsize\ttfamily,
       numbers=left,numberstyle=\scriptsize,stepnumber=1,numbersep=5pt,
       breaklines=true,
       %firstnumber=last,
           %frame=tblr,
           framesep=5pt,
           showstringspaces=false,
           keywordstyle=\itshape\color{blue},
          %identifierstyle=\ttfamily,
           stringstyle=\xecolor{maroon},
        commentstyle=\color{black},
        rulecolor=\color{black},
        xleftmargin=0pt,
        xrightmargin=0pt,
        aboveskip=\medskipamount,
        belowskip=\medskipamount,
               backgroundcolor=\color{white}, #1
}}
{}

\lstnewenvironment{myjavacode}[1][]
      {\lstset{language=JAVA}\lstset{escapeinside={(*@}{@*)},
       breaklines=true,
       %firstnumber=last,
           %frame=tblr,
           framesep=5pt,
           basicstyle=\scriptsize\ttfamily,
           showstringspaces=false,
           keywordstyle=\itshape\color{blue},
          %identifierstyle=\ttfamily,
           stringstyle=\xecolor{maroon},
        commentstyle=\color{black},
        rulecolor=\color{black},
        xleftmargin=0pt,
        xrightmargin=0pt,
        aboveskip=\medskipamount,
        belowskip=\medskipamount,
        backgroundcolor=\color{white}, #1
}}
{}

\lstnewenvironment{myxmlcode}[1][]
      {\lstset{language=XML}\lstset{escapeinside={(*@}{@*)},
       breaklines=true,
       %firstnumber=last,
           %frame=tblr,
           framesep=5pt,
           basicstyle=\scriptsize\ttfamily,
           showstringspaces=false,
           keywordstyle=\itshape\color{blue},
          %identifierstyle=\ttfamily,
           stringstyle=\xecolor{maroon},
        commentstyle=\color{black},
        rulecolor=\color{black},
        xleftmargin=0pt,
        xrightmargin=0pt,
        aboveskip=\medskipamount,
        belowskip=\medskipamount,
        backgroundcolor=\color{white}, #1
}}
{}


%code listing definition
\lstnewenvironment{mymakefilecode}[1][]
      {\lstset{language=c}\lstset{escapeinside={(*@}{@*)},
       basicstyle=\scriptsize\ttfamily,
       numbers=left,numberstyle=\scriptsize,stepnumber=1,numbersep=5pt,
       breaklines=true,
       %firstnumber=last,
           %frame=tblr,
           framesep=5pt,
           showstringspaces=false,
          %identifierstyle=\ttfamily,
           stringstyle=\xecolor{maroon},
        commentstyle=\color{black},
        rulecolor=\color{black},
        xleftmargin=0pt,
        xrightmargin=0pt,
        aboveskip=\medskipamount,
        belowskip=\medskipamount,
               backgroundcolor=\color{white}, #1
}}
{}

\newcommand\vtextvisiblespace[1][.4em]{%
  \mbox{\kern.06em\vrule height.5ex}%
  \vbox{\hrule width#1}%
  \hbox{\vrule height.5ex}}

  
\definecolor{chapnumberbg}{RGB}{26,40,105}
\definecolor{chapname}{RGB}{100,117,158}  
\titleformat{\chapter} [display] 
  {} % format
  {\raggedleft \huge{第\,\thechapter\,章}}
  {1ex} %sep
  {\raggedleft \Huge } % before
  [\normalfont {\tikz \shade[left color=blue!20,right color=chapnumberbg, shading angle=45] (0,0) rectangle (\textwidth,5pt);}]% after
  \makeatother  

\newcommand\abstractname{Abstract}  %%% here
\makeatletter
\if@titlepage
  \newenvironment{abstract}{%
      \titlepage
      \null\vfil
      \@beginparpenalty\@lowpenalty
      \begin{center}%
        \bfseries \abstractname
        \@endparpenalty\@M
      \end{center}}%
     {\par\vfil\null\endtitlepage}
\else
  \newenvironment{abstract}{%
      \if@twocolumn
        \section*{\abstractname}%
      \else
        \small
        \begin{center}%
          {\bfseries \abstractname\vspace{-.5em}\vspace{\z@}}%
        \end{center}%
        \quotation
      \fi}
      {\if@twocolumn\else\endquotation\fi}
\fi
\makeatother  
  
\makeindex

% FIXME , how to use the glossaries?

\input gloss.tex
\makeglossaries

\begin{document}

\begin{titlepage}
\definecolor{titlepagecolor}{cmyk}{1,.60,0,.40}
\pagecolor{titlepagecolor}
\noindent
\includegraphics[width=3cm]{gnu.eps}\\[-1em]
\makebox[0pt][l]{\rule{1.3\textwidth}{1pt}}
\par
\noindent
{\Huge{深入学习IONIC}}

\vfill
\noindent
{\Large {ioniconline.com}}
\vskip\baselineskip
\noindent
\textsf{Dec. 2015}

\clearpage


\vfill\noindent
\vskip \baselineskip
\vspace{3cm}
\centerline{ \Large { }}
\vspace{4cm}
\begin{center}
    \vfill
    \emph{\huge 献给无数工作于手机行业的程序猿们.}\\
    \vspace{0.4cm}
    \hspace{46ex}  \Large ionic学习小组
    \vfill
  \end{center}
  
\begin{centering}
 
\begin{tikzpicture}
% \node [rectangle, font=\Large] {献给无数工作于手机行业的程序猿们};
\end{tikzpicture}
\end{centering}



\end{titlepage}


\restoregeometry 
\pagecolor{white}


\tableofcontents
%show or not show the List-of-Figure
%\listoffigures

\chapter*{序}
\epigraph{这是一本非常好的书}{陈洋(Intel资深工程师)}


\part{基础篇}

\input chap_env.tex 

\input chap_useplugin.tex


\part{高级篇}

\input chap_ajs.tex

\input chap_writeplugin.tex
\input chap_deepplugin.tex

\part{实战篇}

% Here's the Bib
\begin{thebibliography}{99}
\bibitem{bibMasterRegExp} Jeffrey E.F.Friedl: {\em Mastering Regular Expressions}, 2012
\end{thebibliography}


% below try show up Index on the Content
\cleardoublepage
\addcontentsline{toc}{chapter}{Index}

\printglossaries

%index
\printindex



%%

\end{document}
